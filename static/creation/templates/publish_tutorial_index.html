{% extends 'spoken/templates/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% load cmsdata %}
{% load creationdata %}
{% block title %}Tutorials Quality Review Index{% endblock %}
{% block heading %}<i class="fa fa-list-ul"></i> Tutorials Quality Review Index{% endblock %}
{% block content %}
    <!-- Nav tabs -->
    <div class="custom-alert"></div>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <ul class="breadcrumb">
        <li>
            <a href="/creation/quality-review/">
                Waiting for review
            </a>
        </li>
        <li>
            <a href="/creation/public-review/tutorial/index/">
                Ready for Public review
            </a>
        </li>
        <li class="active">Ready to publish</li>
        <li>
            <a href="/creation/public-review/list/">
                Under Public review
            </a>
        </li>
        <li>
            <a href="/creation/quality-review/reviewed/">
                Reviewed
            </a>
        </li>
        <li>
            <a href="/creation/quality-review/tutorial/publish/youtube/">
                Upload to Youtube
            </a>
        </li>
    </ul>
    <div id="load">
    </div>
    <div id="flip-scroll" class="table-responsive">
        <table class="paleblue table table-bordered table-condensed table-hover">
        {% if not collection|length %}
            <tr>
                <td colspan="11" class="col-center">List is empty</td>
            </tr>
        {% else %}
            <thead>
                {% get_sortable_header header ordering request.GET %}
            </thead>
            <tbody>
                {% for tr_rec in collection %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ tr_rec.tutorial_detail.foss.foss }}</td>
                        <td><a href="/creation/tutorial/view/{{ tr_rec.tutorial_detail.foss.foss|get_url_name }}/{{ tr_rec.tutorial_detail.tutorial|get_url_name }}/{{ tr_rec.language.name }}/" target="_blank">{{ tr_rec.tutorial_detail.tutorial }}</a></td>
                        <td>{{ tr_rec.language.name }}</td>
                        <td class="col-center" title="{{ tr_rec.outline_status | get_review_status_list }}">
                            <span class="{{ tr_rec.outline_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.script_status | get_review_status_list }}">
                            <span class="{{ tr_rec.script_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.slide_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.slide_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.video_status | get_review_status_list }}">
                            <span class="{{ tr_rec.video_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.code_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.code_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.assignment_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.assignment_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.additional_material_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.additional_material_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.prerequisite_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.prerequisite_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center" title="{{ tr_rec.common_content.keyword_status | get_review_status_list }}">
                            <span class="{{ tr_rec.common_content.keyword_status | get_review_status_symbol }}"></span>
                        </td>
                        <td class="col-center"> 
                            <div class="review-btn">
                                <button id="{{ tr_rec.id }}" style = "background: transparent; outline: none; border: none; height: 30px; color: teal;" onclick="move(this)" class="fa fa-cog fa-2">
                                </button>
                                Publish
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        {% endif %}
        </table>
    </div>
        

    <script>
         function move(element){ 
            var id = element.id;
            var load = document.getElementById("load");
            var ele = document.getElementById("non-spin");
            load.innerHTML = '<div id="spinner" class="fa fa-spinner fa-spin" style="font-size:48px;color:teal;"></div> The selected video is published on site. Uploading to youtube...';
            var str = "../";
            var string = str.concat(id);
           // location.href = string;
						var xhttp = new XMLHttpRequest();
						xhttp.onreadystatechange = function() {
							if (this.readyState == 4 && this.status == 200) {
								var response = xhttp.responseText;
								if (response == "done") {
                                    load.innerHTML=''; 
                                    location.reload();
								}
                                else if (response == "not done"){
                                    load.innerHTML = 'Some Error Occurred ! Please check the file availability or try after few minutes.';
                                }
							}
						};
						xhttp.open("GET", string, true);
						xhttp.send();		
					
        }
          
    </script>

    




          
{% endblock %}
{% block uncompressjsblock %}
    <script src="{% static 'spoken/js/jquery.fancybox.pack.js' %}"></script>
    <script src="{% static 'spoken/js/jquery.mousewheel-3.0.6.pack.js' %}"></script>
{% endblock %}
{% block compressinlinejsblock %}






<script type="text/javascript">
    
        $(document).ready(function(){
            $(".review-btn").hover(
                function () {
                    $(this).children(0).addClass("fa-spin");
                },
                function () {
                    $(this).children(0).removeClass("fa-spin");
                }
            );
        });

    </script>
{% endblock %}