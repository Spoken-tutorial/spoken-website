{% extends 'spoken/templates/base.html' %}
{% load widget_tweaks %}
{% load static %}
{% block title %}Invigilator Request{% endblock %}
{% block heading %}
    <i class="fa fa-list-ul"></i> Invigilator Request<a href="/software-training" class='pull-right go-back'>Dashboard</a>
{% endblock %}
{% block content %}
    <div class="row well">
        <div class='col-sm-8'>
            <form action="{{ action }}" method="post" class='form-horizontal'>{% csrf_token %}
                {% with WIDGET_ERROR_CLASS='field-error' WIDGET_REQUIRED_CLASS='field-required' %}
                    {% if form.non_field_errors %}
                    <ul>
                      {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                      {% endfor %}
                    </ul>
                    {% endif %}

                    <div class="form-group">
                        <label for="id_state" class="col-sm-3 control-label">State</label>
                        <div class="col-sm-9">
                            {% render_field form.state class+="form-control state" tabindex="1" data-placeholder="Choose State" %}
                            <small>Please select the state in which your institution is located.</small>
                            {{ form.state.errors }}
                        </div>
                    </div>
                    <!--
                    <div class="form-group">
                        <label for="id_district" class="col-sm-3 control-label">District <span class='ajax-refresh ajax-refresh-district'><i class="fa fa-2 fa-refresh fa-spin"></i></span></label>
                        <div class="col-sm-9">
                            {% render_field form.district class+="form-control district" tabindex="1" data-placeholder="Choose district" %}
                            {{ form.district.errors }}
                        </div>
                    </div>
                    -->
                    <div class="form-group">
                        <label for="id_college" class="col-sm-3 control-label">Institution <span class='ajax-refresh ajax-refresh-institution'><i class="fa fa-2 fa-refresh fa-spin"></i></span></label>
                        <div class="col-sm-9">
                            {% render_field form.college class+="form-control college" tabindex="1" data-placeholder="Choose Institution" %}
                            <small>Please select <strong>Only</strong> the exact name of your Institution / College / Politechnic / ITI.</small><br>
                            <small>If your institution's name is missing, please contact the <a href="http://process.spoken-tutorial.org/index.php/Software-Training#Contacts_For_Training" target="_blank">Training Manager</a> of your state.</small>
                            {{ form.college.errors }}
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-3 col-sm-9">
                            <input class="btn btn-primary" type="submit" value="Submit" />
                        </div>
                    </div>
                {% endwith %}
            </form>
        </div>
    </div>
{% endblock %}

{% block compressinlinejsblock %}
<script>
    $(document).ready(function(){
        $acstate = $('.state');
        //$ac_district = $(".district");
        $college = $(".college");

        $acstate.change(function() {
            var state = $(this).val();
            if(state){
                $.ajax({
                    url: "/software-training/ajax-state-collage/",
                    type: "POST",
                    data: {
                        state : state
                    },
                    beforeSend: function() {
                        $('.ajax-refresh-institution').show();
                    },
                    success: function(data) {
                        if(data){
                            $college.html(data);
                            $college.removeAttr("disabled");
                            $('.ajax-refresh-institution').hide();
                        } else{
                            $college.attr("disabled", "disabled");
                            $('.ajax-refresh-institution').hide();
                            alert('No college found for this district!!');
                        }
                    }
                });
            }
        });
    });
</script>
{% endblock %}
